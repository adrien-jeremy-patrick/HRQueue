<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">


<head th:replace="fragments/header :: head">
    <meta charset="UTF-8" />
    <title>Home</title>
</head>
<body>

<div th:if="${user.isAdmin()}==true">
    <nav th:replace="fragments/admin-navbar :: admin-navbar" />
</div>

<div th:if="${user.isAdmin()}==false">
    <nav th:replace="fragments/rep-navbar :: rep-navbar" />
</div>

<div class="body-div">
    <div class="dashboard-wrapper">
        <h1>Welcome, <span th:text="${user.username}"/></h1>
        <h1>Admin: <span th:text="${user.isAdmin()}"/></h1>
    <div th:if="${user.isAdmin() != true}">
        <h1>Open Cases</h1>
        <table class="table table-striped">
            <tr>
                <th scope="col">Customer Name</th>
                <th scope="col">Department</th>
                <th scope="col">Category</th>
                <th scope="col">Sign In Time</th>
                <th scope="col">Assign</th>
            </tr>
            <tr th:each="case : ${allCases}">
                <td th:text="${case.customer_name}"></td>
                <td th:text="${case.department.department}"></td>
                <td th:text="${case.category.category}"></td>
                <td th:text="${case.created_at}"></td>
                <td><a th:href="@{'/case/' + ${case.getId()} + '/assign'}"><button>Assign</button></a></td>
            </tr>
        </table>
        </div>
        <div>
            <h1>Your Assigned Cases</h1>
            <table class="table table-striped">
                <tr>
                    <th scope="col">Customer Name</th>
                    <th scope="col">Department</th>
                    <th scope="col">Category</th>
                    <th scope="col">Sign In Time</th>
                    <span th:if="${user.isAdmin()}">
                        <th scope="col">Delete</th>
                    </span>
                    <th scope="col">Unassign</th>
                    <th scope="col">Complete</th>
                    <th scope="col">Comments</th>
                </tr>
                <tr th:each="case : ${user.getCases()}" >
                    <span th:if="${case.case_closed == null}">
                        <td th:text="${case.customer_name}"></td>
                        <td th:text="${case.department.department}"></td>
                        <td th:text="${case.category.category}"></td>
                        <td th:text="${case.created_at}"></td>
                        <span th:if="${user.isAdmin()}">
                            <td><a th:href="@{'/case/' + ${case.getId()} + '/delete'}"><button>Delete</button></a></td>
                        </span>
                        <td><a th:href="@{'/case/' + ${case.getId()} + '/unassign'}"><button>Unassign</button></a></td>
                        <td><a th:href="@{'/case/' + ${case.getId()} + '/complete'}"><button>Complete</button></a></td>
                        <td><a th:href="@{'/case/' + ${case.getId()} + '/comment'}"><button>Comments</button></a></td>
                    </span>
                </tr>
            </table>
        </div>
        <div>
            <div th:if="${user.isAdmin() == true}">
                <h1>Manage Cases</h1>
            </div>
            <div th:if="${user.isAdmin() != true}">
                <h1>Your Closed Cases</h1>
            </div>
            <table class="table table-striped">
                <tr>
                    <th scope="col">Customer Name</th>
                    <th scope="col">Department</th>
                    <th scope="col">Category</th>

                    <div th:if="${user.isAdmin() != true}">
                        <th scope="col">Completed</th>
                    </div>
                    <div th:if="${user.isAdmin()}">
                        <th scope="col">Status</th>
                        <th scope="col">Assigned User</th>
                    </div>
                    <div th:if="${user.isAdmin()}">
                        <th scope="col">Assign</th>
                        <th scope="col">Delete</th>
                        <th scope="col">Open</th>
                        <th scope="col">Comments</th>
                    </div>
                </tr>
                <tr th:each="case : ${closedCases}">
                    <td th:text="${case.customer_name}"></td>
                    <td th:text="${case.department.department}"></td>
                    <td th:text="${case.category.category}"></td>
                    <span th:if="${user.isAdmin()}">
                        <span th:if="${case.case_closed != null}">
                            <td>Complete</td>
                        </span>
                        <span th:if="${case.case_open != null && case.case_closed == null}">
                            <td>Working</td>
                        </span>
                        <span th:if="${case.case_open == null}">
                            <td>Open</td>
                        </span>
                    </span>
                    <span th:if="${user.isAdmin() != true}"><td th:text="${case.case_closed}"></td></span>
                    <span th:if="${user.isAdmin()}">
                        <span th:if="${case.writer == null}">
                        <td>Open</td>
                        </span>
                        <span th:if="${case.writer != null}">
                        <td th:text="${case.writer.username}"></td>
                        </span>
                    </span>
                    <span th:if="${case.writer != null}">
                        <span th:if="${case.case_closed == null}">
                            <span th:if="${user.isAdmin()}"><td><a th:href="@{'/case/' + ${case.getId()} + '/unassign'}"><button>Unassign</button></a></td></span>
                        </span>
                        <span th:if="${case.case_closed != null}">
                            <td>Complete</td>
                        </span>
                    </span>
                    <span th:if="${case.writer == null}">
                        <span th:if="${user.isAdmin()}"><td><a th:href="@{'/case/' + ${case.getId()} + '/assign'}"><button>Assign</button></a></td></span>
                    </span>
                    <span th:if="${user.isAdmin()}"><td><a th:href="@{'/case/' + ${case.getId()} + '/delete'}"><button>Delete</button></a></td></span>
                    <span th:if="${user.isAdmin()}"><td><a th:href="@{'/case/' + ${case.getId()} + '/open'}"><button>Open</button></a></td></span>
                    <span th:if="${user.isAdmin()}"><td><a th:href="@{'/case/' + ${case.getId()} + '/comment'}"><button>Comments</button></a></td></span>
                </tr>
            </table>
        </div>
    </div>
</div>




<nav th:replace="fragments/footer :: footer" />



</body>
</html>
